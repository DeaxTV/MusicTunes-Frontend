import{P as y}from"../../../../../chunks/playlistPanelVideoRenderer.js";import{f as m}from"../../../../../chunks/utils.js";import{e as p,j as R}from"../../../../../chunks/index2.js";import{b as x}from"../../../../../chunks/request.js";function C(t){if("playlistPanelVideoRenderer"in t)return y(t.playlistPanelVideoRenderer)}function P(t){return!!t}function g(t=[],e,r,n,o){return{currentMixId:n.playlistId,continuation:e,clickTrackingParams:r,visitorData:o,results:m(t,C,P)}}const A=async({url:t})=>{const e=t.searchParams,r=e.get("params")||void 0,n=e.get("visitorData")||"CgtlV0xyWk92dWZ5Zyilgu6ZBg%3D%3D",o=e.get("loggingContext")||"",i=e.get("videoId")||"",s=e.get("playlistId")||"RDAMVM"+(i??""),a=e.has("ctoken")?decodeURIComponent(decodeURIComponent(e.get("ctoken"))):void 0,c=parseInt(e.get("index"))||void 0,l=e.get("clickTracking")||void 0,b=e.get("playlistSetVideoId")||void 0,u=await x("next",{context:{clickTracking:{clickTrackingParams:l?decodeURIComponent(decodeURIComponent(l)):void 0},client:{clientName:"WEB_REMIX",clientVersion:"1.20220404.01.00",visitorData:n}},params:{loggingContext:{vssLogingContext:{serializedContextData:o??void 0}},enablePersistentPlaylistPanel:!0,isAudioOnly:!0,tunerSettingValue:"AUTOMIX_SETTING_NORMAL",continuation:a,videoId:i,index:c,playlistSetVideoId:b,playlistId:s,params:r??""},headers:{}}).then(d=>{if(!d.ok)throw p(500,d.statusText);return d.json()});if(!a){const d=k(u);return R(Object.assign({},d,{response:u}))}return R(Object.assign({},I(u),{response:u}))};function k(t){try{const e=t?.contents?.singleColumnMusicWatchNextResultsRenderer?.tabbedRenderer?.watchNextTabbedResultsRenderer?.tabs||[],r=Array.isArray(e)&&e[2]?.tabRenderer?.endpoint?.browseEndpoint,n=Array.isArray(e[0]?.tabRenderer?.content?.musicQueueRenderer?.content?.playlistPanelRenderer?.contents)&&e[0]?.tabRenderer?.content?.musicQueueRenderer?.content?.playlistPanelRenderer?.contents,o=Array.isArray(n)&&n[n.length-1]?.playlistPanelVideoRenderer?.navigationEndpoint?.clickTrackingParams||null,i=Array.isArray(t?.contents?.singleColumnMusicWatchNextResultsRenderer?.tabbedRenderer?.watchNextTabbedResultsRenderer?.tabs[0]?.tabRenderer?.content?.musicQueueRenderer?.content?.playlistPanelRenderer?.continuations)&&t?.contents?.singleColumnMusicWatchNextResultsRenderer?.tabbedRenderer?.watchNextTabbedResultsRenderer?.tabs[0]?.tabRenderer?.content?.musicQueueRenderer?.content?.playlistPanelRenderer?.continuations[0]?.nextRadioContinuationData?.continuation||null,s=t?.currentVideoEndpoint?.watchEndpoint,a=t?.responseContext?.visitorData,c=g(n,i,o,s||"",a);return Object.assign(c,{related:r})}catch(e){throw console.error(e),p(500,e)}}function I(t){const{responseContext:e={},continuationContents:{playlistPanelContinuation:{contents:r=[],continuations:[{nextRadioContinuationData:{continuation:n=""}={}}={}]=[],...o}={}}={}}=t,i=r.at(-1)?.playlistPanelVideoRenderer?.navigationEndpoint?.clickTrackingParams,s=e?.visitorData,a=g(r,n,i,o,s),c=t?.contents?.singleColumnMusicWatchNextResultsRenderer?.tabbedRenderer?.watchNextTabbedResultsRenderer?.tabs||[],l=Array.isArray(c)&&c[2]?.tabRenderer?.endpoint?.browseEndpoint;return Object.assign(a,{related:l})}export{A as GET};

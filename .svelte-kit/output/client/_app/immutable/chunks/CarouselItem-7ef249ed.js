import { S as ge, i as me, T as ye, k as S, a as Y, w as pe, q as O, l as b, m as T, c as x, h as m, x as fe, r as Q, n as u, $ as ee, G, b as j, I as v, y as he, L as z, W as Ie, f as X, g as ve, t as J, d as we, u as K, z as _e, D as Se, V as te, A as be, a1 as Ae, e as se, _ as ae, M as Te } from "./index-02d4e276.js"; import { g as M } from "./navigation-8392efd7.js"; import { L as Ee } from "./Loading-becb9104.js"; import { l as N, o as P, n as ie, k as H, r as Pe, L as Ne } from "./window-19724ee6.js"; import { I as Ce } from "./buffer-8e6379eb.js"; import { b as Le, s as ke, P as Re } from "./PopperButton-b3b94d20.js"; import "./Icon-53721fee.js"; import { S as Ge } from "./url-fcaf9571.js"; const Me = (e, t) => { e.includes("ARTIST") ? M(`/artist/${t}`) : e.includes("PLAYLIST") ? M("/playlist/" + t) : M("/release?type=" + encodeURIComponent(e) + "&id=" + encodeURIComponent(t)) }; async function Ze({ item: e, index: t, isBrowseEndpoint: l, type: s, kind: a }) { var o, i, n, w, p, f, g; return s === "trending" && ((i = (o = e.endpoint) == null ? void 0 : o.pageType) != null && i.match(/ALBUM|SINGLE/m) ? M("/release?type=" + encodeURIComponent((n = e == null ? void 0 : e.endpoint) == null ? void 0 : n.pageType) + "&id=" + encodeURIComponent((w = e.endpoint) == null ? void 0 : w.browseId)) : (await N.initAutoMixSession({ videoId: e.videoId, playlistId: e.playlistId, loggingContext: (e == null ? void 0 : e.loggingContext) || null, keyId: a === "isPlaylist" ? t : 0, config: { type: e == null ? void 0 : e.musicVideoType } }), N.updatePosition(a === "isPlaylist" ? t : 0))), (p = e == null ? void 0 : e.endpoint) != null && p.pageType.includes("ARTIST") && M(`/artist/${(f = e == null ? void 0 : e.endpoint) == null ? void 0 : f.browseId}`), !l && e.videoId !== void 0 && !((g = e == null ? void 0 : e.endpoint) != null && g.pageType.includes("ARTIST")) ? await N.initAutoMixSession({ loggingContext: e == null ? void 0 : e.loggingContext, videoId: e.videoId, playlistId: e.playlistId, keyId: s !== "home" ? t : void 0 }) : Me(e.endpoint.pageType, e.endpoint.browseId), !1 } function le({ origin: e, title: t, type: l = null, id: s }) { switch (l) { case "MUSIC_PAGE_TYPE_ALBUM": return { url: `${e}/release?id=${s}`, title: t }; case "MUSIC_PAGE_TYPE_ARTIST": return { title: t, url: `${e}/artist/${s}` }; case "MUSIC_PAGE_TYPE_PLAYLIST": return { title: t, url: `${e}/playlist/${s}` }; case "SESSION": return { title: t, url: `${e}/session?token=${s}` }; default: return { url: `${e}/listen?id=${s}`, title: t } } } function ne(e, t, l) { const s = e.slice(); return s[20] = t[l], s } function re(e) { let t, l; return t = new Ee({}), { c() { pe(t.$$.fragment) }, l(s) { fe(t.$$.fragment, s) }, m(s, a) { he(t, s, a), l = !0 }, i(s) { l || (X(t.$$.fragment, s), l = !0) }, o(s) { J(t.$$.fragment, s), l = !1 }, d(s) { _e(t, s) } } } function oe(e) { let t, l = e[1].subtitle, s = []; for (let a = 0; a < l.length; a += 1)s[a] = ce(ne(e, l, a)); return { c() { t = S("div"); for (let a = 0; a < s.length; a += 1)s[a].c(); this.h() }, l(a) { t = b(a, "DIV", { class: !0 }); var o = T(t); for (let i = 0; i < s.length; i += 1)s[i].l(o); o.forEach(m), this.h() }, h() { u(t, "class", "subtitles secondary svelte-zs3tpa") }, m(a, o) { j(a, t, o); for (let i = 0; i < s.length; i += 1)s[i].m(t, null) }, p(a, o) { if (o & 2) { l = a[1].subtitle; let i; for (i = 0; i < l.length; i += 1) { const n = ne(a, l, i); s[i] ? s[i].p(n, o) : (s[i] = ce(n), s[i].c(), s[i].m(t, null)) } for (; i < s.length; i += 1)s[i].d(1); s.length = l.length } }, d(a) { a && m(t), Ae(s, a) } } } function ze(e) { let t, l, s = e[20].text + "", a, o, i, n; function w() { return e[15](e[20]) } return { c() { t = S("a"), l = S("span"), a = O(s), this.h() }, l(p) { t = b(p, "A", { href: !0, class: !0 }); var f = T(t); l = b(f, "SPAN", { class: !0 }); var g = T(l); a = Q(g, s), g.forEach(m), f.forEach(m), this.h() }, h() { var p; u(l, "class", "svelte-zs3tpa"), u(t, "href", o = "/artist/" + ((p = e[20]) == null ? void 0 : p.browseId)), u(t, "class", "svelte-zs3tpa") }, m(p, f) { j(p, t, f), v(t, l), v(l, a), i || (n = z(t, "click", Ie(Te(w))), i = !0) }, p(p, f) { var g; e = p, f & 2 && s !== (s = e[20].text + "") && K(a, s), f & 2 && o !== (o = "/artist/" + ((g = e[20]) == null ? void 0 : g.browseId)) && u(t, "href", o) }, d(p) { p && m(t), i = !1, n() } } } function Be(e) { let t, l = e[20].text + "", s; return { c() { t = S("span"), s = O(l), this.h() }, l(a) { t = b(a, "SPAN", { class: !0 }); var o = T(t); s = Q(o, l), o.forEach(m), this.h() }, h() { u(t, "class", "svelte-zs3tpa") }, m(a, o) { j(a, t, o), v(t, s) }, p(a, o) { o & 2 && l !== (l = a[20].text + "") && K(s, l) }, d(a) { a && m(t) } } } function ce(e) { let t; function l(o, i) { var n; return (n = o[20]) != null && n.browseId ? ze : Be } let s = l(e), a = s(e); return { c() { a.c(), t = se() }, l(o) { a.l(o), t = se() }, m(o, i) { a.m(o, i), j(o, t, i) }, p(o, i) { s === (s = l(o)) && a ? a.p(o, i) : (a.d(1), a = s(o), a && (a.c(), a.m(t.parentNode, t))) }, d(o) { a.d(o), o && m(t) } } } function De(e) { let t, l, s, a, o, i, n, w, p, f, g, L, k, E, A, _, C, R = e[1].title + "", Z, B, y, D, r, d = e[7] && re(); E = new Le({ props: { tabindex: 0, items: e[5] } }); let h = e[1].subtitle && oe(e); return { c() { t = S("article"), l = S("section"), s = S("section"), a = S("div"), d && d.c(), o = Y(), i = S("img"), L = Y(), k = S("div"), pe(E.$$.fragment), A = Y(), _ = S("div"), C = S("span"), Z = O(R), B = Y(), h && h.c(), this.h() }, l(c) { t = b(c, "ARTICLE", { class: !0 }); var I = T(t); l = b(I, "SECTION", { class: !0 }); var V = T(l); s = b(V, "SECTION", { class: !0 }); var W = T(s); a = b(W, "DIV", { class: !0, tabindex: !0 }); var F = T(a); d && d.l(F), o = x(F), i = b(F, "IMG", { alt: !0, loading: !0, width: !0, height: !0, src: !0, "data-src": !0, class: !0 }), F.forEach(m), L = x(W), k = b(W, "DIV", { class: !0 }); var q = T(k); fe(E.$$.fragment, q), q.forEach(m), W.forEach(m), V.forEach(m), A = x(I), _ = b(I, "DIV", { class: !0 }); var U = T(_); C = b(U, "SPAN", { class: !0 }); var $ = T(C); Z = Q($, R), $.forEach(m), B = x(U), h && h.l(U), U.forEach(m), I.forEach(m), this.h() }, h() { u(i, "alt", "thumbnail img" + e[9]), u(i, "loading", n = e[0] >= 3 ? "lazy" : null), u(i, "width", w = e[6].width), u(i, "height", p = e[6].height), ee(i.src, f = e[0] >= 3 ? e[6].placeholder : e[6].url) || u(i, "src", f), u(i, "data-src", g = e[0] >= 3 ? e[6].url : null), u(i, "class", "svelte-zs3tpa"), u(a, "class", "image img" + e[9] + " svelte-zs3tpa"), u(a, "tabindex", "0"), G(a, "active", e[10]), G(a, "isArtistKind", e[8]), u(k, "class", "item-menu svelte-zs3tpa"), u(s, "class", "item-thumbnail img" + e[9] + " svelte-zs3tpa"), G(s, "isArtistKind", e[8]), u(l, "class", "item-thumbnail-wrapper img" + e[9] + " svelte-zs3tpa"), u(C, "class", "h1 link svelte-zs3tpa"), u(_, "class", "item-title svelte-zs3tpa"), G(_, "isArtistKind", e[8]), u(t, "class", "item item" + e[9] + " svelte-zs3tpa") }, m(c, I) { j(c, t, I), v(t, l), v(l, s), v(s, a), d && d.m(a, null), v(a, o), v(a, i), v(s, L), v(s, k), he(E, k, null), v(t, A), v(t, _), v(_, C), v(C, Z), v(_, B), h && h.m(_, null), y = !0, D || (r = [z(i, "error", Xe), z(s, "focus", e[13]), z(s, "blur", e[14]), z(t, "contextmenu", e[16]), z(t, "click", Ie(e[17]))], D = !0) }, p(c, [I]) { c[7] ? d ? I & 128 && X(d, 1) : (d = re(), d.c(), X(d, 1), d.m(a, o)) : d && (ve(), J(d, 1, 1, () => { d = null }), we()), (!y || I & 1 && n !== (n = c[0] >= 3 ? "lazy" : null)) && u(i, "loading", n), (!y || I & 64 && w !== (w = c[6].width)) && u(i, "width", w), (!y || I & 64 && p !== (p = c[6].height)) && u(i, "height", p), (!y || I & 65 && !ee(i.src, f = c[0] >= 3 ? c[6].placeholder : c[6].url)) && u(i, "src", f), (!y || I & 65 && g !== (g = c[0] >= 3 ? c[6].url : null)) && u(i, "data-src", g), (!y || I & 256) && G(a, "isArtistKind", c[8]); const V = {}; I & 32 && (V.items = c[5]), E.$set(V), (!y || I & 256) && G(s, "isArtistKind", c[8]), (!y || I & 2) && R !== (R = c[1].title + "") && K(Z, R), c[1].subtitle ? h ? h.p(c, I) : (h = oe(c), h.c(), h.m(_, null)) : h && (h.d(1), h = null), (!y || I & 256) && G(_, "isArtistKind", c[8]) }, i(c) { y || (X(d), X(E.$$.fragment, c), y = !0) }, o(c) { J(d), J(E.$$.fragment, c), y = !1 }, d(c) { c && m(t), d && d.d(), _e(E), h && h.d(), D = !1, Se(r) } } } const de = /PLAYLIST|ALBUM|SINGLE/, Ve = /=w\d+-h\d+-/gm, Xe = e => { e.currentTarget.onerror = null, e.currentTarget.src = "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJpc29sYXRpb246aXNvbGF0ZSIgdmlld0JveD0iMCAwIDI1NiAyNTYiIHdpZHRoPSIyNTZwdCIgaGVpZ2h0PSIyNTZwdCI+PGRlZnM+PGNsaXBQYXRoIGlkPSJwcmVmaXhfX2EiPjxwYXRoIGQ9Ik0wIDBoMjU2djI1NkgweiIvPjwvY2xpcFBhdGg+PC9kZWZzPjxnIGNsaXAtcGF0aD0idXJsKCNwcmVmaXhfX2EpIj48cGF0aCBmaWxsPSIjNDI0MjQyIiBkPSJNMCAwaDI1NnYyNTZIMHoiLz48ZyBjbGlwLXBhdGg9InVybCgjcHJlZml4X19iKSI+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTA1LjU0IDE2Ni43OTQpIiBmb250LWZhbWlseT0ic3lzdGVtLXVpLC1hcHBsZS1zeXN0ZW0sQmxpbmtNYWNTeXN0ZW1Gb250LCZxdW90O1NlZ29lIFVJJnF1b3Q7LFJvYm90byxPeHlnZW4sVWJ1bnR1LENhbnRhcmVsbCwmcXVvdDtPcGVuIFNhbnMmcXVvdDssJnF1b3Q7SGVsdmV0aWNhIE5ldWUmcXVvdDssc2Fucy1zZXJpZiIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1zaXplPSIxMDAiIGZpbGw9IiNmYWZhZmEiPj88L3RleHQ+PC9nPjxkZWZzPjxjbGlwUGF0aCBpZD0icHJlZml4X19iIj48cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5MiA1NC44MzkpIiBkPSJNMCAwaDcydjE0Ni4zMjNIMHoiLz48L2NsaXBQYXRoPjwvZGVmcz48L2c+PC9zdmc+" }; function je(e, t) { e.preventDefault(), window.dispatchEvent(new CustomEvent("contextmenu", { detail: "carouselItem" })), Re.set({ items: t, x: e.pageX, y: e.pageY, direction: "normal" }) } const We = ["Favorite", "Add to Queue", "View Artist"], ue = ["Favorite", "Play Next", "View Artist"]; function Fe(e, t, l) { let s, a, o; te(e, N, r => l(12, a = r)), te(e, Ge, r => l(18, o = r)); let { index: i } = t, { item: n } = t, { type: w = "" } = t, { kind: p = "" } = t, { aspectRatio: f } = t, { isBrowseEndpoint: g = !1 } = t, L = !1; const E = !!(f != null && f.includes("TWO_LINE_STACK") && p !== "Fans might also like" || f != null && f.includes("16_9")) ? "16x9" : "1x1"; let A = [{ text: "View Artist", icon: "artist", action: async () => { try { const r = n.artistInfo ? n.artistInfo.artist[0].browseId : n.subtitle[0].browseId; if (!r) throw new Error(`Expected a valid artistId string, received ${r}`); M(`/artist/${r}`), await be(), window.scrollTo({ behavior: "smooth", top: 0, left: 0 }) } catch (r) { P(`Error: ${r}`, "error") } } }, { text: "Add to Queue", icon: "queue", action: function () { N.setTrackWillPlayNext(n, a.mix.length), P(`${n.title} has been added to your queue!`, "success") } }, { text: "Play Next", icon: "queue", action() { N.setTrackWillPlayNext(n, a.position), P(`${n.title} will play next!`, "success") } }, { text: "Add to Playlist", icon: "list-plus", action: async () => { var r; if ((r = n.endpoint) != null && r.pageType.match(de)) { const c = await (await fetch("/api/v1/get_queue.json?playlistId=" + n.playlistId)).json(); ie.set({ state: !0, item: [...c] }) } else ie.set({ state: !0, item: n }) } }, { text: "Favorite", icon: "heart", action: () => { ke.sendMessage("create", "favorite", n) } }, H.hasActiveSession ? { text: "Share Group Session", icon: "share", action: async () => { const r = le({ type: "SESSION", title: `Join ${H.client.displayName}'s MusicTunes Session`, id: encodeURIComponent(Ce.toBase64(JSON.stringify({ clientId: H.client.clientId, displayName: H.client.displayName }))), origin: o }); try { navigator.canShare ? await navigator.share(r).then(() => { P("Shared successfully", "success") }).catch(d => { Ne.err(d) }) : (await navigator.clipboard.writeText(r.url), P("Link copied successfully", "success")) } catch (d) { P("Error: " + d, "error") } } } : { text: "Start Group Session", icon: "users", action: async () => { Pe.set(!0) } }, { text: "Share", icon: "share", action: async () => { var d, h; const r = le({ origin: o, id: ((d = n.endpoint) == null ? void 0 : d.browseId) ?? n.videoId, type: ((h = n.endpoint) == null ? void 0 : h.pageType) ?? null, title: n.title }); try { navigator.canShare ? (await navigator.share(r), P("Shared successfully", "success")) : (await navigator.clipboard.writeText(r.url), P("Link copied successfully", "success")) } catch (c) { P("Error: " + c, "error") } } }], _ = Array.isArray(n == null ? void 0 : n.thumbnails) ? n == null ? void 0 : n.thumbnails.at(0) : { width: 0, height: 0, url: "", placeholder: "" }, C; function R(r) { ae.call(this, e, r) } function Z(r) { ae.call(this, e, r) } const B = r => { M("/artist/" + (r == null ? void 0 : r.browseId)) }, y = r => je(r, A), D = async r => { l(7, L = !0), l(7, L = await Ze({ isBrowseEndpoint: g, index: i, item: n, kind: p, type: w })) }; return e.$$set = r => { "index" in r && l(0, i = r.index), "item" in r && l(1, n = r.item), "type" in r && l(2, w = r.type), "kind" in r && l(3, p = r.kind), "aspectRatio" in r && l(11, f = r.aspectRatio), "isBrowseEndpoint" in r && l(4, g = r.isBrowseEndpoint) }, e.$$.update = () => { var r, d, h; e.$$.dirty & 4134 && ((w === "artist" || n.endpoint && ((r = n.endpoint.pageType) != null && r.includes("MUSIC_PAGE_TYPE_ARTIST"))) && l(5, A = A.filter(c => We.includes(c.text))), (d = n.endpoint) != null && d.pageType && l(5, A = (h = n == null ? void 0 : n.endpoint) != null && h.pageType.match(de) ? [{ action: () => { N.initPlaylistSession({ playlistId: n.playlistId, params: "wAEB8gECKAE%3D", index: 0 }) }, icon: "shuffle", text: "Shuffle" }, { action: () => { N.setTrackWillPlayNext(n, a.position) }, icon: "queue", text: "Play Next" }, { action: () => { N.initPlaylistSession({ playlistId: "RDAMPL" + n.playlistId, params: "wAEB8gECeAE%3D", index: 0 }) }, icon: "radio", text: "Start Radio" }, ...A.filter(c => !ue.includes(c.text))] : A.filter(c => ue.includes(c.text)))), e.$$.dirty & 64 && l(6, _.url = _.width < 100 ? _.url.replace(Ve, "=w240-h240-") : _.url, _), e.$$.dirty & 8 && l(8, s = p === "Fans might also like") }, [i, n, w, p, g, A, _, L, s, E, C, f, a, R, Z, B, y, D] } class qe extends ge { constructor(t) { super(), me(this, t, Fe, De, ye, { index: 0, item: 1, type: 2, kind: 3, aspectRatio: 11, isBrowseEndpoint: 4 }) } } export { qe as C };

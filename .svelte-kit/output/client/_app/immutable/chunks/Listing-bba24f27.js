import { S as Le, i as $e, T as je, k as v, a as Q, q as M, w as Se, l as y, m as I, c as Y, h as _, r as R, x as Te, n as f, $ as pe, G as se, b as P, I as m, y as Ee, L as te, W as De, M as le, f as X, g as Ne, t as ee, d as Ve, u as z, z as Pe, D as Ge, V as ie, P as Me, an as Re, A as Be, a1 as qe, e as _e } from "./index-02d4e276.js"; import { L as Ce } from "./Loading-becb9104.js"; import { e as Ue, i as Fe, k as j, l as x, n as me, r as We, o as F, J as ge, L as ze } from "./window-19724ee6.js"; import { g as W } from "./navigation-8392efd7.js"; import { I as He } from "./buffer-8e6379eb.js"; import { b as Je, s as ve, P as Oe } from "./PopperButton-b3b94d20.js"; import "./Icon-53721fee.js"; import { S as Qe } from "./url-fcaf9571.js"; function ye(l, s, i) { const t = l.slice(); return t[19] = s[i], t } function be(l, s, i) { const t = l.slice(); return t[16] = s[i], t } function we(l) { let s, i; return s = new Ce({ props: { size: "3em" } }), { c() { Se(s.$$.fragment) }, l(t) { Te(s.$$.fragment, t) }, m(t, a) { Ee(s, t, a), i = !0 }, i(t) { i || (X(s.$$.fragment, t), i = !0) }, o(t) { ee(s.$$.fragment, t), i = !1 }, d(t) { Pe(s, t) } } } function Ye(l) { var a; let s, i = (a = l[0]) == null ? void 0 : a.subtitle, t = []; for (let r = 0; r < i.length; r += 1)t[r] = Ie(ye(l, i, r)); return { c() { s = v("p"); for (let r = 0; r < t.length; r += 1)t[r].c(); this.h() }, l(r) { s = y(r, "P", { class: !0 }); var e = I(s); for (let c = 0; c < t.length; c += 1)t[c].l(e); e.forEach(_), this.h() }, h() { f(s, "class", "text-artist secondary svelte-17q0dj9") }, m(r, e) { P(r, s, e); for (let c = 0; c < t.length; c += 1)t[c].m(s, null) }, p(r, e) { var c; if (e & 1) { i = (c = r[0]) == null ? void 0 : c.subtitle; let o; for (o = 0; o < i.length; o += 1) { const d = ye(r, i, o); t[o] ? t[o].p(d, e) : (t[o] = Ie(d), t[o].c(), t[o].m(s, null)) } for (; o < t.length; o += 1)t[o].d(1); t.length = i.length } }, d(r) { r && _(s), qe(t, r) } } } function Xe(l) { let s, i = l[0].type === "playlist" && "metaData" in l[0] ? `${l[0].metaData}` : "", t; return { c() { s = v("p"), t = M(i), this.h() }, l(a) { s = y(a, "P", { class: !0 }); var r = I(s); t = R(r, i), r.forEach(_), this.h() }, h() { f(s, "class", "text-artist svelte-17q0dj9") }, m(a, r) { P(a, s, r), m(s, t) }, p(a, r) { r & 1 && i !== (i = a[0].type === "playlist" && "metaData" in a[0] ? `${a[0].metaData}` : "") && z(t, i) }, d(a) { a && _(s) } } } function Ke(l) { let s, i = l[0].subtitle, t = []; for (let a = 0; a < i.length; a += 1)t[a] = ke(be(l, i, a)); return { c() { s = v("p"); for (let a = 0; a < t.length; a += 1)t[a].c(); this.h() }, l(a) { s = y(a, "P", { class: !0 }); var r = I(s); for (let e = 0; e < t.length; e += 1)t[e].l(r); r.forEach(_), this.h() }, h() { f(s, "class", "artist-stats svelte-17q0dj9") }, m(a, r) { P(a, s, r); for (let e = 0; e < t.length; e += 1)t[e].m(s, null) }, p(a, r) { if (r & 1) { i = a[0].subtitle; let e; for (e = 0; e < i.length; e += 1) { const c = be(a, i, e); t[e] ? t[e].p(c, r) : (t[e] = ke(c), t[e].c(), t[e].m(s, null)) } for (; e < t.length; e += 1)t[e].d(1); t.length = i.length } }, d(a) { a && _(s), qe(t, a) } } } function Ze(l) { let s, i = l[19].text + "", t, a, r, e; function c() { return l[7](l[19]) } return { c() { s = v("a"), t = M(i), this.h() }, l(o) { s = y(o, "A", { href: !0, class: !0 }); var d = I(s); t = R(d, i), d.forEach(_), this.h() }, h() { var o; f(s, "href", a = `/artist/${(o = l[19]) == null ? void 0 : o.browseId}`), f(s, "class", "svelte-17q0dj9") }, m(o, d) { P(o, s, d), m(s, t), r || (e = te(s, "click", le(c)), r = !0) }, p(o, d) { var k; l = o, d & 1 && i !== (i = l[19].text + "") && z(t, i), d & 1 && a !== (a = `/artist/${(k = l[19]) == null ? void 0 : k.browseId}`) && f(s, "href", a) }, d(o) { o && _(s), r = !1, e() } } } function xe(l) { let s, i = l[19].text + "", t, a, r, e; function c() { return l[6](l[19]) } return { c() { s = v("a"), t = M(i), this.h() }, l(o) { s = y(o, "A", { href: !0, class: !0 }); var d = I(s); t = R(d, i), d.forEach(_), this.h() }, h() { var o; f(s, "href", a = `/release?id=${(o = l[19]) == null ? void 0 : o.browseId}`), f(s, "class", "svelte-17q0dj9") }, m(o, d) { P(o, s, d), m(s, t), r || (e = te(s, "click", le(c)), r = !0) }, p(o, d) { var k; l = o, d & 1 && i !== (i = l[19].text + "") && z(t, i), d & 1 && a !== (a = `/release?id=${(k = l[19]) == null ? void 0 : k.browseId}`) && f(s, "href", a) }, d(o) { o && _(s), r = !1, e() } } } function et(l) { let s = l[19].text + "", i; return { c() { i = M(s) }, l(t) { i = R(t, s) }, m(t, a) { P(t, i, a) }, p(t, a) { a & 1 && s !== (s = t[19].text + "") && z(i, s) }, d(t) { t && _(i) } } } function Ie(l) { let s, i; function t(e, c) { return c & 1 && (s = null), e[19].pageType ? (s == null && (s = !!e[19].pageType.includes("ALBUM")), s ? xe : Ze) : et } let a = t(l, -1), r = a(l); return { c() { r.c(), i = _e() }, l(e) { r.l(e), i = _e() }, m(e, c) { r.m(e, c), P(e, i, c) }, p(e, c) { a === (a = t(e, c)) && r ? r.p(e, c) : (r.d(1), r = a(e), r && (r.c(), r.m(i.parentNode, i))) }, d(e) { r.d(e), e && _(i) } } } function ke(l) { let s = l[16].text + "", i; return { c() { i = M(s) }, l(t) { i = R(t, s) }, m(t, a) { P(t, i, a) }, p(t, a) { a & 1 && s !== (s = t[16].text + "") && z(i, s) }, d(t) { t && _(i) } } } function tt(l) { var ne, oe, ce, ue; let s, i, t, a, r, e, c, o, d, k, q, A, h, D = l[0].title + "", S, H, E, L, B, C, U, n, p, b, J, ae, g = l[2] && we(); function re(u, w) { return u[0].type === "artists" ? Ke : u[0].type === "playlist" ? Xe : Ye } let K = re(l), T = K(l); return p = new Je({ props: { metadata: { artist: l[0].type !== "playlist" && Array.isArray((ne = l[0]) == null ? void 0 : ne.subtitle) && [l[0].subtitle.find(Ae) ?? ((oe = l[0].artistInfo) == null ? void 0 : oe.artist[0])], thumbnail: l[0].thumbnails, title: l[0].title, length: l[0].type !== "artist" && l[0].type !== "playlist" ? (ue = (ce = l[0]) == null ? void 0 : ce.length) == null ? void 0 : ue.text : "" }, type: "search", items: l[3] } }), { c() { s = v("div"), i = v("div"), t = v("div"), a = v("div"), g && g.c(), r = Q(), e = v("div"), c = v("img"), q = Q(), A = v("div"), h = v("p"), S = M(D), H = Q(), E = v("span"), L = v("span"), B = M("Explicit"), C = Q(), T.c(), U = Q(), n = v("div"), Se(p.$$.fragment), this.h() }, l(u) { s = y(u, "DIV", { class: !0 }); var w = I(s); i = y(w, "DIV", { class: !0 }); var $ = I(i); t = y($, "DIV", { class: !0 }); var N = I(t); a = y(N, "DIV", { class: !0 }); var V = I(a); g && g.l(V), r = Y(V), e = y(V, "DIV", { class: !0 }); var O = I(e); c = y(O, "IMG", { alt: !0, loading: !0, width: !0, height: !0, src: !0, class: !0 }), O.forEach(_), V.forEach(_), q = Y(N), A = y(N, "DIV", { class: !0 }); var G = I(A); h = y(G, "P", { class: !0 }); var Z = I(h); S = R(Z, D), H = Y(Z), E = y(Z, "SPAN", { class: !0 }); var fe = I(E); L = y(fe, "SPAN", { class: !0 }); var de = I(L); B = R(de, "Explicit"), de.forEach(_), fe.forEach(_), Z.forEach(_), C = Y(G), T.l(G), G.forEach(_), N.forEach(_), U = Y($), n = y($, "DIV", { class: !0 }); var he = I(n); Te(p.$$.fragment, he), he.forEach(_), $.forEach(_), w.forEach(_), this.h() }, h() { f(c, "alt", "thumbnail"), f(c, "loading", "lazy"), f(c, "width", o = l[1].width), f(c, "height", d = l[1].height), pe(c.src, k = l[1].url) || f(c, "src", k), f(c, "class", "svelte-17q0dj9"), f(e, "class", "thumbnail svelte-17q0dj9"), f(a, "class", "img-container svelte-17q0dj9"), se(a, "artist-img", l[4]), f(L, "class", "sr-only"), f(E, "class", "explicit svelte-17q0dj9"), se(E, "hidden", !l[0].explicit), f(h, "class", "text-title svelte-17q0dj9"), f(A, "class", "title svelte-17q0dj9"), f(t, "class", "itemWrapper svelte-17q0dj9"), f(n, "class", "menu svelte-17q0dj9"), f(i, "class", "innercard svelte-17q0dj9"), f(s, "class", "container svelte-17q0dj9") }, m(u, w) { P(u, s, w), m(s, i), m(i, t), m(t, a), g && g.m(a, null), m(a, r), m(a, e), m(e, c), m(t, q), m(t, A), m(A, h), m(h, S), m(h, H), m(h, E), m(E, L), m(L, B), m(A, C), T.m(A, null), m(i, U), m(i, n), Ee(p, n, null), b = !0, J || (ae = [te(t, "click", De(l[5])), te(s, "contextmenu", le(l[8]))], J = !0) }, p(u, [w]) { var N, V, O, G; u[2] ? g ? w & 4 && X(g, 1) : (g = we(), g.c(), X(g, 1), g.m(a, r)) : g && (Ne(), ee(g, 1, 1, () => { g = null }), Ve()), (!b || w & 2 && o !== (o = u[1].width)) && f(c, "width", o), (!b || w & 2 && d !== (d = u[1].height)) && f(c, "height", d), (!b || w & 2 && !pe(c.src, k = u[1].url)) && f(c, "src", k), (!b || w & 1) && D !== (D = u[0].title + "") && z(S, D), (!b || w & 1) && se(E, "hidden", !u[0].explicit), K === (K = re(u)) && T ? T.p(u, w) : (T.d(1), T = K(u), T && (T.c(), T.m(A, null))); const $ = {}; w & 1 && ($.metadata = { artist: u[0].type !== "playlist" && Array.isArray((N = u[0]) == null ? void 0 : N.subtitle) && [u[0].subtitle.find(Ae) ?? ((V = u[0].artistInfo) == null ? void 0 : V.artist[0])], thumbnail: u[0].thumbnails, title: u[0].title, length: u[0].type !== "artist" && u[0].type !== "playlist" ? (G = (O = u[0]) == null ? void 0 : O.length) == null ? void 0 : G.text : "" }), w & 8 && ($.items = u[3]), p.$set($) }, i(u) { b || (X(g), X(p.$$.fragment, u), b = !0) }, o(u) { ee(g), ee(p.$$.fragment, u), b = !1 }, d(u) { u && _(s), g && g.d(), T.d(), Pe(p), J = !1, Ge(ae) } } } const st = /=w\d+-h\d+-/gm, Ae = l => { var s; return (s = l == null ? void 0 : l.pageType) == null ? void 0 : s.includes("ARTIST") }; function it(l, s, i) { var B, C, U; let t, a, r; ie(l, Qe, n => i(11, t = n)), ie(l, Ue, n => i(12, a = n)), ie(l, Fe, n => i(13, r = n)); let { data: e } = s; const c = Me(); let o = !!Re("library"), d = "", k = "", q = Array.isArray(e == null ? void 0 : e.subtitle) && ((B = e.subtitle[0]) == null ? void 0 : B.text) === "Artist", A = !1, h = [{ text: "View Artist", icon: "artist", action: async () => { var n; window.scrollTo({ behavior: "smooth", top: 0, left: 0 }), await Be(), W(`/artist/${((n = e == null ? void 0 : e.subtitle.find(p => { var b; return (b = p == null ? void 0 : p.pageType) == null ? void 0 : b.includes("ARTIST") })) == null ? void 0 : n.browseId) ?? e.artistInfo.artist[0].browseId}`) } }, { text: "Go to Album", icon: "album", action: () => { var n; window.scrollTo({ behavior: "smooth", top: 0, left: 0 }), W(`/release?id=${(n = e == null ? void 0 : e.album) == null ? void 0 : n.browseId}`) } }, { text: "Play Next", icon: "queue", action: () => j.hasActiveSession ? j.addToQueue(e, r) : x.setTrackWillPlayNext(e, r) }, { text: "Add to Queue", icon: "queue", action: () => j.hasActiveSession ? j.addToQueue(e, a.length) : x.setTrackWillPlayNext(e, a.length) }, { text: "Add to Playlist", icon: "list-plus", action: async () => { var n; if ((n = e == null ? void 0 : e.endpoint) != null && n.pageType.match(/PLAYLIST|ALBUM|SINGLE/)) { const J = await (await fetch("/api/v1/get_queue.json?playlistId=" + (e == null ? void 0 : e.playlistId))).json(); me.set({ state: !0, item: [...J] }) } else me.set({ state: !0, item: e }) } }, { text: o ? "Remove From Favorites" : "Favorite", icon: o ? "x" : "heart", action: async () => { !o && ve.sendMessage("create", "favorite", e), o && (await ve.sendMessage("delete", "favorite", e), c("update")) } }, j.hasActiveSession ? { text: "Invite Group Session", icon: "send", action: async () => { const n = { title: `Join ${j.client.displayName}'s Group Session on MusicTunes!`, url: `${t}/session?token=${He.toBase64(JSON.stringify({ clientId: j.client.clientId, displayName: j.client.displayName }))}` }; try { if (!navigator.canShare) await navigator.clipboard.writeText(n.url), F("Link copied successfully", "success"); else { const p = await navigator.share(n); F("Shared successfully", "success") } } catch (p) { F("Error: " + p, "error") } } } : { text: "Start Group Session", icon: "users", action: async () => { We.set(!0) } }, { text: "Share", icon: "share", action: async () => { const n = { title: e.title, url: `${t}/listen?id=${e.videoId}` }; try { navigator.canShare ? (await navigator.share(n), F("Shared successfully", "success")) : (await navigator.clipboard.writeText(n.url), F("Link copied successfully", "success")) } catch (p) { F("Error: " + p, "error") } } }]; q && (h = h.filter(n => { var p; return !((p = n.text) != null && p.includes("Add to Playlist")) })), (C = e.type) != null && C.includes("playlist") && (h.splice(1, 1, { text: "View Playlist", icon: "list", action: () => { var n; window.scrollTo({ behavior: "smooth", top: 0, left: 0 }), W(`/playlist/${(n = e == null ? void 0 : e.endpoint) == null ? void 0 : n.browseId}`) } }), h.shift(), h.pop(), h = h.filter(n => !n.text.includes("Favorite"))), e.type === "videos" && (h = h.filter(n => { n.text })), ((U = e == null ? void 0 : e.album) == null ? void 0 : U.browseId) === void 0 && (h = ge(h, n => n.text !== "Go to Album")), q && (h = ge(h, n => n.text !== "View Artist")); const D = async n => { var p; if (!(n.target instanceof HTMLElement && (n.target.nodeName === "A" || n.target.nodeName === "P") || A)) { if (q) { W(`/artist/${e.artistInfo.artist[0].browseId}`); return } try { i(2, A = !0), d = e.videoId ? e.videoId : "", k = e != null && e.playlistId ? e == null ? void 0 : e.playlistId : "", (p = e.type) != null && p.includes("playlist") || (e == null ? void 0 : e.type) === "albums" ? await x.initPlaylistSession({ playlistId: k, index: 0, clickTrackingParams: e.clickTrackingParams ?? void 0, params: e.params }) : await x.initAutoMixSession({ loggingContext: e == null ? void 0 : e.loggingContext, videoId: d, playlistId: k, keyId: 0, clickTracking: e.params, config: { playerParams: e.playerParams, type: e.musicVideoType } }), i(2, A = !1); return } catch (b) { ze.err(b); return } } }; let S = Array.isArray(e == null ? void 0 : e.thumbnails) ? e == null ? void 0 : e.thumbnails.at(0) : { width: 0, height: 0, url: "", placeholder: "" }; const H = n => W(`/release?id=${n == null ? void 0 : n.browseId}`), E = n => W(`/artist/${n == null ? void 0 : n.browseId}`), L = n => { window.dispatchEvent(new window.CustomEvent("contextmenu", { detail: "listing" })), Oe.set({ items: h.slice(), x: n.pageX, y: n.pageY, direction: "right" }) }; return l.$$set = n => { "data" in n && i(0, e = n.data) }, l.$$.update = () => { l.$$.dirty & 2 && i(1, S.url = S.width < 100 ? S.url.replace(st, "=w240-h240-") : S.url, S) }, [e, S, A, h, q, D, H, E, L] } class dt extends Le { constructor(s) { super(), $e(this, s, it, tt, je, { data: 0 }) } } export { dt as L };
